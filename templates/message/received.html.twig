{% extends 'base.html.twig' %}

{% block title %}Messagerie !{% endblock %}

{% block body %}
    <main class="message">
        <nav class="message__nav">
            <a href="{{ path('message_list') }}" class="message__nav__link">Accueil</a>
            <a href="{{ path('message_received') }}" class="message__nav__link">Messages reçus ({{ app.user.profile.received|length }})</a>
            <a href="{{ path('message_sent') }}" class="message__nav__link">Messages Envoyés ({{ app.user.profile.sent|length }})</a>
            <a href="{{ path('message_basket') }}" class="message__nav__link">Corbeille</a>
        </nav>
        <section class="message__content">
            <h1 class="message__content__title">Messagerie de {{ app.user.profile.firstname ~ " " ~ app.user.profile.lastname}}</h1>
            <div class="message__content__block">
                <h2>Boite de réception</h2>
                <p>Vous avez reçus {{ app.user.profile.received|length }} message{{ app.user.profile.received|length > 1 ? "s" : "" }}</p>
                <table>
                    <thead>
                        <tr>
                            <th>De</th>
                            <th>Sujet</th>
                            <th>Date</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for message in app.user.profile.received %}
                            {% if message.isRead == 0 %}
                                {% set bold = "bold" %}
                            {% else %}
                                {% set bold = "" %}
                            {% endif %}
                            <tr>
                                <td class={{bold}}>{{ message.sender.username }}</td>
                                <td class={{bold}}><a href="{{ path('message_read', {id: message.id}) }}">{{ message.title }}</a></td>
                                <td class={{bold}}>{{ message.createdAt|date('d-m-Y') }}</td>
                                <td></td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
                <button class="message__content__button">Voirs mes dossiers</button>
                <button class="message__content__button"><a href="{{ path('message_send') }}" class="message__content__button__link">Envoyé un message</a></button>
            </div>
        </section>
    </main>
{% endblock %}
