{% extends 'base.html.twig' %}

{% block title %}Communauté troc service{% endblock %}
{% set queryParams = app.request.query.all %}
{% set queryString = queryParams|filter((v, k) => k != "page" and k != "ajax")|url_encode %}
{% block body %}
    <main class="community">
        <h1 class="community__title">Liste des membres de la commnuité</h1>
        <section class="community__buttons">
            <button class="community__buttons__item">
                <a href="{{ path('announcement_list') }}">annonces</a>
            </button>
            <button class="community__buttons__item">
                <a href="{{ path('profile_community') }}">membres</a>
            </button>
        </section>
        <h2 class="community__subtitle">Il y a actuellement {{ profiles|length }} membres dans la communautés</h2>
        <section class="community__form">
            {{ form_start(form) }}
                <ul class="community__form__list">
                    <li class="community__form__list__item">{{ form_row(form.username) }}</li>
                    <li class="community__form__list__item">{{ form_row(form.address, {id: 'search_address_profile'}) }}</li>
                    <li class="community__form__list__item">{{ form_row(form.distance) }}</li>
                    {# <li class="community__form__list__item">{{ form_row(form.category) }}</li> #}
                    <li><button class="community__form__button">Rechercher</button></li>
                </ul>    
            {{ form_end(form) }}
        </section>
        <section class="community__content">
            <div class="search__categories">
                <h2 class="search__categories__title">Catégories</h2>
                {% for category in categories %}
                    <p class="search__categories__name"><a href="{{ path('profile_community') }}?category={{ category.id }} ">{{ category.name }}</a></p>
                    {% for subCategory in category.subCategories %}
                        {% if queryParams and queryParams.subCategories is defined %}
                            {% set checked = (subCategory.id in queryParams.subCategories) ? "checked" : "" %}
                        {% else %}
                            {% set checked = "" %}
                        {% endif %}
                            <ul class="search__categories__list">
                                <li class="search__categories__list__item"><a href="{{ path('profile_community') }}?subCategory={{ subCategory.id }}">{{subCategory.name}} </a></li>
                            </ul>
                        {% endfor %}                
                {% endfor %}
                <input type="hidden" name="page" value="{{page}}">
            </div>

            <div class="search__content__announces" id="content">
                {% include "profile/_content.html.twig" %}
            </div>
        </section>
    </main>
{% endblock %}

{# 

<div class="community__list__card__right">
    <div class="community__list__card__right__top">
        <p class="community__list__card__right__top__username"><i class="las la-user-tie la-lg"></i> {{ profile.username }}</p>
        <p class="community__list__card__right__top__city"><i class="las la-map-marker-alt la-lg"></i>{{ profile.region ~ '/' ~ profile.department ~ '/' ~ profile.city }}</p>
    </div>
    <div class="community__list__card__right__content">
        <p class="community__list__card__right__content__propose">
            <strong>Je recherche : </strong>
            {% if profile.propose %}
                {{ profile.propose }}
            {% else %}
                rien pour le moment    
            {% endif %}
        </p>
        <p class="community__list__card__right__content__research">
            <strong>Je propose : </strong>
            {% if profile.research %}
                {{ profile.research }}
            {% else %}
                rien pour le moment    
            {% endif %}
            <button class="community__list__card__right__content__btn">Voir le profil</button>
        </p>
    </div>
</div> #}